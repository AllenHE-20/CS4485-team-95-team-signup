<!DOCTYPE html>
<html lang="en">
<%- include("partials/doc-head.ejs", {title: "Team Formation"}); %>
<body>

<%- include('partials/header.ejs'); %>

<div class="function-container">
    <div class="function-item">        
        <form action="/admin/generate-teams" method="get">
            <label for="maxTeam">Max Team Size</label>
            <input type="text" name="maxTeam" id="maxTeam" />            
            <input type="submit" value="Regenerate" />            
        </form>        
    </div>

    <div class="function-item" id="save-item">        
        <form action="/admin/save-teams" method="post">
            <% teams.forEach((team, index) => { %>                
                <input type="hidden" name="teams[<%= index %>].teamID" value="<%= team.id %>">                

                <% (team.currentMemberNames).forEach((currName, currIndex) => { %>                
                    <input type="hidden" name="teams[<%= index %>].currentMemberNames[currIndex]" value="<%= currName %>">                
                <% }) %>

                <% (team.newMemberNames).forEach((newName, newIndex) => { %>                
                    <input type="hidden" name="teams[<%= index %>].newMemberNames[newIndex]" value="<%= newName %>">                
                <% }) %>

                <% (team.newMemberIDs).forEach((id, idIndex) => { %>                
                    <input type="hidden" name="teams[<%= index %>].newMemberIDs[idIndex]" value="<%= id %>">                
                <% }) %>

                <% (team.projectPreferences).forEach((projPref, prefIndex) => { %>                
                    <input type="hidden" name="teams[<%= index %>].projectPreferences[prefIndex]" value="<%= projPref %>">                
                <% }) %>

                <% (team.currentSkills).forEach((skill, skillIndex) => { %>                
                    <input type="hidden" name="teams[<%= index %>].currentSkills[skillIndex]" value="<%= skill %>">                
                <% }) %>

                <% (team.newSkills).forEach((newSkill, newSkillIndex) => { %>                
                    <input type="hidden" name="teams[<%= index %>].newSkills[newSkillIndex]" value="<%= newSkill %>">                
                <% }) %>

                <% console.log(teams[index]); %>
            <% }) %>
            <input id="saveAllTeams" type="submit" value="Save All Teams" />
        </form>    
    </div>
</div>
    
<main class="adminPage">   
    
    <article>
        <ul class="profile-list" id="projectList">    
            <% for (let i = 0; i < teams.length; i++) { %>    
                <li class="profile-item" style="display: block;">                                                                    
                    <div class="genCard">    
                        <h1>
                            Team <%= teams[i].teamID %>                             
                        </h1>                                            
                        <p>Members: 
                            <%= teams[i].currentMemberNames.join(', ') %>,
                            <%= teams[i].newMemberNames.join(', ') %>                         
                        </p>                     
                        <p>Project Preferences:
                            <%= teams[i].projectPreferences.join(', ') %>
                        </p>
                        <p>Skills:
                            <%= teams[i].currentSkills.join(', ') %>,
                            <%= teams[i].newSkills.join(', ') %>
                        </p>

                        <form action="" method="post">
                            <input id="saveTeam<%= i %>" type="submit" value="Save Team" />
                        </form>
                    </div>                      
                </li>          
            <% } %>
        </ul>
    </article>                  
</main>


</body>
</html>
