<!DOCTYPE html>
<html lang="en">
<%- include("partials/doc-head.ejs", {title: "Team Formation"}); %>
<body>

<%- include('partials/header.ejs'); %>

<div class="function-container">
    <div class="function-item">        
        <form action="/admin/generate-teams" method="get">
            <label for="maxTeam">Max Team Size</label>
            <input type="text" name="maxTeam" id="maxTeam" />            
            <input type="submit" value="Regenerate" />            
        </form>        
    </div>
    
    <div class="function-item" id="save-item">                
        <form id="saveTeamsForm" action="/admin/save-teams" method="post">                                     
            <% for (let i = 0; i < genTeams.length; i++) { %>
                <% const team = {
                    teamID: genTeams[i].teamID,
                    newMemberIDs: []
                }; %>

                <input type="hidden" name="teams[<%= i %>][id]" value="<%= team.teamID %>">                                    
            
                <% for (let j = 0; j < genTeams[i].newMemberIDs.length; j++) { %>
                    <% team.newMemberIDs.push(genTeams[i].newMemberIDs[j]); %>
                    <input type="hidden" name="teams[<%= i %>][newMemberIDs][<%= j %>]" value="<%= team.newMemberIDs[j] %>">                    
                <% } %>                                
            <% } %>                                                                       
            <input id="saveAllTeams" type="submit" value="Save All Teams" />
        </form>    
    </div>
</div>
    
<main class="adminPage">   
    
    <article>
        <ul class="profile-list" id="projectList">    
            <% for (let i = 0; i < genTeams.length; i++) { %>    
                <li class="profile-item" style="display: block;">                                                                    
                    <div class="genCard">    
                        <h1>
                            Team <%= genTeams[i].teamID %>                             
                        </h1>   

                        <p>Members: 
                            <% if(genTeams[i].currentMemberNames.length > 0) { %>
                                <%= genTeams[i].currentMemberNames.join(', ') %>,
                            <% } %>
                            <%= genTeams[i].newMemberNames.join(', ') %>                         
                        </p>        

                        <p>Project Preferences:
                            <% if(genTeams[i].projectPreferences.length === 0) { %>
                                N/A
                            <% } else { %>                                
                                <%= genTeams[i].projectPreferences.join(', ') %>
                            <% } %>
                        </p>

                        <p>Skills:  
                            <% if((genTeams[i].currentSkills).length === 0 && (genTeams[i].newSkills).length === 0) { %>
                                N/A
                            <% } else { %>
                                <% if(genTeams[i].currentSkills.length > 0) { %>
                                    <%= genTeams[i].currentSkills.join(', ') %>,
                                <% } %>
                                <%= genTeams[i].newSkills.join(', ') %>
                            <% } %>
                        </p>

                        <form action="" method="post">
                            <input id="saveTeam<%= i %>" type="submit" value="Save Team" />
                        </form>
                    </div>                      
                </li>          
            <% } %>
        </ul>
    </article>                  
</main>
<% console.log(genTeams); %>


</body>
</html>
